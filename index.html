<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anne - AI Waifu Assistant</title>
    <link rel="stylesheet" href="style.css">
    <!-- 引入 Font Awesome 图标库，用于麦克风图标 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>

    <!-- 加载屏幕 -->
    <div id="loading-screen">
        <div class="loading-content">
            <div class="anne-portrait">
                <img src="https://cdn.builder.io/api/v1/image/assets%2Ffa667d61b04349a1b5f967185269a859%2Feeaae84d6cc0451b830ee3d14f416a42?format=webp&width=800" alt="Anne Portrait" class="loading-anne-img">
                <div class="loading-glow"></div>
            </div>
            <div class="anne-logo">ANNE</div>
            <div class="loading-text">Hi, I'm Anne — built with love, powered by Ollama, designed by Hitesh 💜</div>
            <div class="loading-spinner"></div>
        </div>
    </div>

    <!-- Audio System -->
    <audio id="intro-audio" preload="auto" volume="0.5"></audio>
    <audio id="audio-zenith" loop preload="auto" volume="0.3"></audio>
    <audio id="audio-pixi" loop preload="auto" volume="0.3"></audio>
    <audio id="audio-nova" loop preload="auto" volume="0.3"></audio>
    <audio id="audio-velvet" loop preload="auto" volume="0.3"></audio>
    <audio id="audio-blaze" loop preload="auto" volume="0.3"></audio>
    <audio id="audio-aurora" loop preload="auto" volume="0.3"></audio>

    <!-- Intro Video Animation -->
    <div id="intro-video-container" class="intro-video-container">
        <video id="intro-video" class="intro-video" playsinline preload="auto">
            <source src="https://cdn.builder.io/o/assets%2F05795d83a50240879a66a110f8707954%2F723bb05ebc7e4a96aea0aad0e23fb501?alt=media&token=4152e4af-12a2-4ec4-8dc9-5cd324d5381d&apiKey=05795d83a50240879a66a110f8707954" type="video/mp4">
        </video>
        <div class="intro-video-overlay"></div>
        <div class="intro-title">ANNE AI</div>
        <div class="intro-subtitle">Advanced Neural Network Entity</div>
    </div>

    <!-- Personality Transition Video -->
    <div id="transition-video-container" class="transition-video-container">
        <video id="transition-video" class="transition-video" muted playsinline preload="auto">
            <source src="https://cdn.builder.io/o/assets%2F05795d83a50240879a66a110f8707954%2F723bb05ebc7e4a96aea0aad0e23fb501?alt=media&token=4152e4af-12a2-4ec4-8dc9-5cd324d5381d&apiKey=05795d83a50240879a66a110f8707954" type="video/mp4">
        </video>
        <div class="transition-caption" id="transition-caption">Switching to Welcoming...</div>
    </div>

    <!-- Cinematic Video Background -->
    <div class="video-background-container">
        <video class="cinematic-video" id="cinematic-video" autoplay muted loop playsinline preload="auto">
            <source src="https://cdn.builder.io/o/assets%2Ffa667d61b04349a1b5f967185269a859%2F72d38cc9d9e64117a9b6c3498ffbfdef?alt=media&token=1a867bde-328c-4e1a-96f2-614778f8f639&apiKey=fa667d61b04349a1b5f967185269a859" type="video/mp4">
            <!-- WebM fallback for better compatibility -->
            <source src="https://cdn.builder.io/o/assets%2Ffa667d61b04349a1b5f967185269a859%2F72d38cc9d9e64117a9b6c3498ffbfdef?alt=media&token=1a867bde-328c-4e1a-96f2-614778f8f639&apiKey=fa667d61b04349a1b5f967185269a859" type="video/webm">
        </video>
        <div class="video-glow-overlay"></div>
    </div>

    <!-- Anne Background -->
    <div class="anne-container">
        <div class="anne-background">
            <div class="mood-ring" id="mood-ring"></div>
            <img src="https://cdn.builder.io/api/v1/image/assets%2Ffa667d61b04349a1b5f967185269a859%2Feeaae84d6cc0451b830ee3d14f416a42?format=webp&width=800" alt="Anne" class="anne-main-img" id="anne-main-img">
            <div class="anne-particles" id="anne-particles"></div>

            <!-- Current Personality Avatar Badge -->
            <div class="personality-avatar-badge" id="personality-avatar">
                <img src="https://cdn.builder.io/api/v1/image/assets%2Ffa667d61b04349a1b5f967185269a859%2Feeaae84d6cc0451b830ee3d14f416a42?format=webp&width=800" alt="Current Personality" id="avatar-img">
                <div class="avatar-pulse-ring" id="avatar-ring"></div>
                <div class="avatar-label" id="avatar-label">ZENITH</div>
            </div>
        </div>
    </div>

    <!-- Anne Personality Sidebar -->
    <div class="personality-sidebar" id="personality-sidebar">
        <div class="sidebar-header">
            <h3>ANNE'S PERSONALITIES</h3>
            <div class="ai-status-panel">
                <div class="status-indicator" id="sidebar-status">
                    <span class="status-dot" id="sidebar-status-dot"></span>
                    <span class="status-text" id="sidebar-status-text">Initializing...</span>
                </div>
                <button class="reconnect-btn" id="reconnect-btn" title="Reconnect to Ollama">
                    <i class="fas fa-sync-alt"></i>
                </button>
            </div>
        </div>

        <!-- Enhanced Selection Display -->
        <div class="selected-personality-display" id="selected-personality-display">
            <div class="selected-image-container">
                <img src="https://cdn.builder.io/api/v1/image/assets%2Ffa667d61b04349a1b5f967185269a859%2Feeaae84d6cc0451b830ee3d14f416a42?format=webp&width=800" alt="Selected Anne" class="selected-personality-img" id="selected-personality-img">
                <div class="selection-glow-ring"></div>
                <div class="selection-particles"></div>
            </div>
            <div class="selected-personality-info">
                <div class="selected-label" id="selected-label">WELCOMING</div>
                <div class="selected-desc" id="selected-desc">Sweet & Caring</div>
            </div>
        </div>

        <div class="personality-grid">
            <div class="personality-card active" data-personality="zenith">
                <img src="https://cdn.builder.io/api/v1/image/assets%2Ffa667d61b04349a1b5f967185269a859%2Feeaae84d6cc0451b830ee3d14f416a42?format=webp&width=800" alt="Zenith">
                <div class="personality-label">ZENITH</div>
                <div class="personality-desc">💖 Welcoming</div>
                <div class="card-glow-effect zenith-glow"></div>
                <div class="audio-visualizer" id="viz-zenith"></div>
            </div>

            <div class="personality-card" data-personality="blaze">
                <img src="https://cdn.builder.io/api/v1/image/assets%2Ffa667d61b04349a1b5f967185269a859%2F005a15af210d4f08a16c100cfa44824c?format=webp&width=800" alt="Blaze">
                <div class="personality-label">BLAZE</div>
                <div class="personality-desc">😈 Flirty</div>
                <div class="card-glow-effect blaze-glow"></div>
                <div class="audio-visualizer" id="viz-blaze"></div>
            </div>

            <div class="personality-card" data-personality="pixi">
                <img src="https://cdn.builder.io/api/v1/image/assets%2Ffa667d61b04349a1b5f967185269a859%2Fe68ae80624f34ce3a4387915b9605722?format=webp&width=800" alt="Pixi">
                <div class="personality-label">PIXI</div>
                <div class="personality-desc">🎉 Playful</div>
                <div class="card-glow-effect pixi-glow"></div>
                <div class="audio-visualizer" id="viz-pixi"></div>
            </div>

            <div class="personality-card" data-personality="nova">
                <img src="https://cdn.builder.io/api/v1/image/assets%2Ffa667d61b04349a1b5f967185269a859%2F417a7d864e7b4d43a753589d6c319df0?format=webp&width=800" alt="Nova">
                <div class="personality-label">NOVA</div>
                <div class="personality-desc">🦾 Confident</div>
                <div class="card-glow-effect nova-glow"></div>
                <div class="audio-visualizer" id="viz-nova"></div>
            </div>

            <div class="personality-card" data-personality="velvet">
                <img src="https://cdn.builder.io/api/v1/image/assets%2Ffa667d61b04349a1b5f967185269a859%2F1077ea0a19484cf2b28f3136a22ce91c?format=webp&width=800" alt="Velvet">
                <div class="personality-label">VELVET</div>
                <div class="personality-desc">🔥 Seductive</div>
                <div class="card-glow-effect velvet-glow"></div>
                <div class="audio-visualizer" id="viz-velvet"></div>
            </div>

            <div class="personality-card" data-personality="aurora">
                <img src="https://cdn.builder.io/api/v1/image/assets%2Ffa667d61b04349a1b5f967185269a859%2F060d04d5760e4253930d2417bc9e0db0?format=webp&width=800" alt="Aurora">
                <div class="personality-label">AURORA</div>
                <div class="personality-desc">👑 Elegant</div>
                <div class="card-glow-effect aurora-glow"></div>
                <div class="audio-visualizer" id="viz-aurora"></div>
            </div>
        </div>
    </div>

    <!-- 内容层，覆盖在视频之上 -->
    <div class="content-overlay">

        <!-- 顶部好感度条 -->
        <header class="top-bar">
            <div class="status-row">
                <label for="favorability-bar">NEURAL SYNC</label>
                <div class="ai-status" id="ai-status">
                    <span class="status-dot"></span>
                    <span class="status-text">Initializing...</span>
                </div>
            </div>
            <div class="progress-container">
                <div class="progress-fill" id="favorability-bar"></div>
            </div>
        </header>

        <!-- 语音识别结果显示区域 -->
        <div class="transcript-container">
            <p id="transcript"></p>
        </div>

        <!-- Enhanced Anne Chat Interface -->
        <div class="anne-chat-container enhanced" role="region" aria-label="Chat with Anne">
            <!-- Chat Header -->
            <div class="chat-header">
                <div class="chat-title">
                    <i class="fas fa-comments"></i>
                    <span>Direct Chat with Anne</span>
                </div>
                <div class="chat-controls">
                    <button class="chat-toggle-btn" id="chat-toggle-btn" title="Toggle Chat Window">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>
            </div>

            <!-- Chat Messages Area -->
            <div class="chat-content" id="chat-content">
                <div class="chat-messages" id="chat-messages" role="log" aria-live="polite" aria-label="Chat conversation" tabindex="0">
                    <div class="chat-message anne welcome-message">
                        <div class="message-bubble anne">
                            💜 Hello darling! I'm Anne, your AI companion. You can type to me or use voice chat - just click the microphone! ✨
                        </div>
                    </div>
                </div>

                <!-- Enhanced Input Container -->
                <div class="chat-input-container" role="group" aria-label="Message input">
                    <!-- Voice Input Button -->
                    <button id="voice-input-btn"
                            class="voice-input-btn"
                            type="button"
                            role="button"
                            aria-label="Start voice recording"
                            title="Click to speak">
                        <i class="fas fa-microphone"></i>
                        <span class="voice-status">Speak</span>
                    </button>

                    <!-- Text Input -->
                    <div class="input-wrapper">
                        <input type="text"
                               id="chat-input"
                               placeholder="Type or speak your message..."
                               class="chat-input"
                               role="textbox"
                               aria-label="Type your message to Anne"
                               aria-describedby="chat-shortcuts-help"
                               autocomplete="off">
                        <i class="fas fa-keyboard input-icon" aria-hidden="true"></i>
                    </div>

                    <!-- Send Button -->
                    <button id="chat-send"
                            class="chat-send-btn"
                            type="button"
                            role="button"
                            aria-label="Send message to Anne"
                            tabindex="0">
                        <i class="fas fa-paper-plane" aria-hidden="true"></i>
                    </button>
                </div>

                <!-- Voice Chat Status -->
                <div class="voice-chat-status" id="voice-chat-status">
                    <div class="voice-indicator">
                        <i class="fas fa-circle-dot"></i>
                        <span id="voice-status-text">Ready for voice chat</span>
                    </div>
                    <div class="voice-controls">
                        <button class="voice-settings-btn" id="voice-settings-btn" title="Voice Settings">
                            <i class="fas fa-cog"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div id="chat-shortcuts-help" class="sr-only">
                Press Enter to send message, Escape to clear, Ctrl+/ to focus input, Alt+S to focus send button, Alt+V to toggle voice input, Alt+M to toggle chat window
            </div>
        </div>

        <!-- 悬浮球 -->
        <div id="floating-button">
            <i class="fas fa-bars"></i>
        </div>

        <!-- 悬浮菜单 -->
        <div id="menu-container" class="hidden">
            <div class="menu-header">💜 Anne's Performances</div>
            <button class="menu-item" data-video="视频资源/jimeng-2025-07-16-4437-比耶，然后微笑着优雅的左右摇晃.mp4">Victory Pose</button>
            <button class="menu-item" data-video="视频资源/jimeng-2025-07-16-1043-笑着优雅的左右摇晃，过一会儿手扶着下巴，保持微笑.mp4">Elegant Sway</button>
            <button class="menu-item" data-video="视频资源/jimeng-2025-07-17-1871-优雅的摇晃身体 微笑.mp4">Gentle Dance</button>
            <button class="menu-item" data-video="视频资源/jimeng-2025-07-17-2665-若有所思，手扶下巴.mp4">Thoughtful</button>
            <button class="menu-item" data-video="视频资源/生成加油视频.mp4">Cheer Up</button>
            <button class="menu-item" data-video="视频资源/生成跳舞视频.mp4">Dance Party</button>
            <button class="menu-item negative" data-video="视频资源/负面/jimeng-2025-07-16-9418-双手叉腰，嘴巴一直在嘟囔，表情微微生气.mp4">Pouting</button>
        </div>

        <!-- Audio Control -->
        <div class="audio-control-container">
            <button class="audio-toggle-btn" id="audio-toggle-btn" title="Toggle Audio">
                <i class="fas fa-volume-up" id="audio-icon"></i>
            </button>
        </div>

        <!-- TTS Control Panel -->
        <div class="tts-control-panel" id="tts-control-panel">
            <div class="tts-status">
                <span class="tts-indicator" id="tts-indicator">🎤</span>
                <span class="tts-status-text" id="tts-status-text">Voice Loading...</span>
            </div>
            <div class="tts-controls">
                <button class="tts-test-btn" id="tts-test-btn" title="Test Voice">Test Voice</button>
                <div class="volume-control">
                    <i class="fas fa-volume-down"></i>
                    <input type="range" id="volume-slider" min="0" max="100" value="80" class="volume-slider">
                    <i class="fas fa-volume-up"></i>
                </div>
            </div>
        </div>

    </div>

    <!-- Made by Hitesh Label - Always Visible -->
    <div class="made-by-hitesh" id="made-by-hitesh">
        <span class="credit-text">Made by Hitesh</span>
        <div class="credit-underline"></div>
    </div>

    <script src="js/anne-tts-enhanced.js"></script>
    <script src="js/anne-voice-chat.js"></script>
    <script type="module" src="anne-enhanced.js"></script>
    <script src="js/anne-premium-features.js"></script>
    <script src="js/anne-control-panel.js"></script>
</body>
</html>
